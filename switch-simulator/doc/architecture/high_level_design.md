# Switch Simulator - High Level Design

## Overview

Switch Simulator представляет собой программное обеспечение, которое эмулирует функциональность сетевого коммутатора. Симулятор предназначен для тестирования, обучения и разработки приложений, взаимодействующих с сетевыми коммутаторами без необходимости использования физического оборудования.

## Архитектурные принципы

1. **Модульность** - Система разделена на независимые компоненты с четко определенными интерфейсами
2. **Абстракция оборудования** - HAL (Hardware Abstraction Layer) обеспечивает отделение логики от специфики оборудования
3. **Совместимость с SAI** - Поддержка Switch Abstraction Interface для стандартизации взаимодействия
4. **Расширяемость** - Архитектура позволяет добавлять новые протоколы и функции

## Архитектурные компоненты

### Board Support Package (BSP)
Обеспечивает базовую инициализацию и настройку виртуального оборудования, включая драйверы и конфигурацию.

### Hardware Abstraction Layer (HAL)
Предоставляет абстракцию над виртуальным оборудованием, включая порты, пакеты и аппаратные ресурсы.

### L2 Components
Компоненты второго уровня, включающие:
- MAC-таблицу и механизм обучения
- VLAN и работу с тегами
- Spanning Tree Protocol (STP)

### L3 Components
Компоненты третьего уровня, включающие:
- IP-обработку пакетов
- Таблицу маршрутизации
- Поддержку протоколов маршрутизации (OSPF, RIP)
- ARP-протокол

### SAI Layer
Реализация Switch Abstraction Interface, предоставляющая стандартизированный API для:
- Управления портами
- Настройки VLAN
- Управления маршрутизацией

### Management
Компоненты управления симулятором:
- CLI-движок
- Сбор статистики
- Управление конфигурацией

### Python API & CLI
Интерфейсы для взаимодействия с симулятором:
- Python API для программного управления
- CLI для пользовательского взаимодействия

## Поток данных

1. Входящие пакеты принимаются на виртуальных портах через HAL
2. Пакеты проходят обработку L2 (VLAN, MAC-таблица)
3. Если требуется маршрутизация, пакеты передаются на L3-обработку
4. Обработанные пакеты отправляются на выходные порты
5. Все действия логируются и собирается статистика

## Интеграция компонентов

```
+-------------+     +-------------+     +-------------+
|  Python API |     |     CLI     |     |   External  |
|  & Scripts  |     |  Interface  |     | Applications|
+------+------+     +------+------+     +------+------+
       |                   |                   |
       v                   v                   v
+---------------------------------------------+
|                 SAI Interface               |
+---------------------------------------------+
       |                   |                   |
       v                   v                   v
+-------------+     +-------------+     +-------------+
|     L2      |     |     L3      |     | Management  |
| Components  |     | Components  |     | Components  |
+------+------+     +------+------+     +------+------+
       |                   |                   |
       v                   v                   v
+---------------------------------------------+
|       Hardware Abstraction Layer (HAL)      |
+---------------------------------------------+
                       |
                       v
+---------------------------------------------+
|          Board Support Package (BSP)        |
+---------------------------------------------+
                       |
                       v
+---------------------------------------------+
|              Simulation Engine              |
+---------------------------------------------+
```

## Дальнейшее развитие

Планируемые направления развития:
1. Расширение поддержки протоколов L2/L3
2. Улучшение производительности симуляции
3. Добавление возможностей тестирования и отладки
4. Расширение функциональности CLI и API
